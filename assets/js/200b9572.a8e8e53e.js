"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1821],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var r=n.createContext({}),s=function(e){var t=n.useContext(r),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(r.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=s(a),h=o,m=u["".concat(r,".").concat(h)]||u[h]||d[h]||i;return a?n.createElement(m,l(l({ref:t},c),{},{components:a})):n.createElement(m,l({ref:t},c))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,l=new Array(i);l[0]=u;var p={};for(var r in t)hasOwnProperty.call(t,r)&&(p[r]=t[r]);p.originalType=e,p.mdxType="string"==typeof e?e:o,l[1]=p;for(var s=2;s<i;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},610:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>r,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>p,toc:()=>s});var n=a(3117),o=(a(7294),a(3905));const i={sidebar_position:8},l="SAGE3 API Usage",p={unversionedId:"API-usage",id:"API-usage",title:"SAGE3 API Usage",description:"Introduction",source:"@site/docs/API-usage.md",sourceDirName:".",slug:"/API-usage",permalink:"/docs/API-usage",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/API-usage.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Application Development",permalink:"/docs/Application-Development"},next:{title:"Server Deployment",permalink:"/docs/Server-Deployment"}},r={},s=[{value:"Introduction",id:"introduction",level:2},{value:"Application",id:"application",level:2},{value:"Application Components",id:"application-components",level:3},{value:"State Definition",id:"state-definition",level:3},{value:"Using the state",id:"using-the-state",level:3},{value:"Update the state",id:"update-the-state",level:3},{value:"Toolbar",id:"toolbar",level:3},{value:"Data Stores",id:"data-stores",level:2},{value:"Application Store",id:"application-store",level:3},{value:"UIStore Store",id:"uistore-store",level:3},{value:"Asset Store",id:"asset-store",level:3}],c={toc:s};function d(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"sage3-api-usage"},"SAGE3 API Usage"),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Before you start, make sure you have the SAGE3 backend running. See ",(0,o.kt)("a",{parentName:"li",href:"/docs/Application-Development#integrated-application"},"Integrated Application")," for more information."),(0,o.kt)("li",{parentName:"ul"},"Use the application generator to create a new application. See ",(0,o.kt)("a",{parentName:"li",href:"/docs/Application-Development#web-development"},"Web development")," to scaffold a new application with the associated data schema and various source files."),(0,o.kt)("li",{parentName:"ul"},"The SAGE3 API is a REST/WS API that is used to communicate with the backend. However, most of the functionality is abstracted away in data stores, containing data and functions to operate on specific collections (user, board, rooms, applications, etc)."),(0,o.kt)("li",{parentName:"ul"},"An application is defined by its state (data values stored in the application) and two components, the application window and its toolbar. The state type is specified through an application schema.")),(0,o.kt)("h2",{id:"application"},"Application"),(0,o.kt)("h3",{id:"application-components"},"Application Components"),(0,o.kt)("p",null,"A SAGE3 application defines two components: the application window defined as ",(0,o.kt)("inlineCode",{parentName:"p"},"AppComponent")," and the application toolbar defined as ",(0,o.kt)("inlineCode",{parentName:"p"},"ToolbarComponent"),". The application window is the main component of the application, and is displayed on the board. The application toolbar is displayed below the application window when the application is selected by the user. Both components receive the application state as a React prop and return a React component (",(0,o.kt)("inlineCode",{parentName:"p"},"JSX.Element"),"). The prop is the full application element from the application collection, and contains the application state, as well as the ",(0,o.kt)("inlineCode",{parentName:"p"},"_id"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_createdAt"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_updatedAt"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_updatedBy")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"_createdBy")," fields."),(0,o.kt)("p",null,"Both the application window and the toolbar must be exported:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"function AppComponent(props: App): JSX.Element {\n  return <> </>;\n}\n\nfunction ToolbarComponent(props: App): JSX.Element {\n  return <> </>;\n}\n\nexport default { AppComponent, ToolbarComponent };\n")),(0,o.kt)("h3",{id:"state-definition"},"State Definition"),(0,o.kt)("p",null,"We use the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/colinhacks/zod"},(0,o.kt)("inlineCode",{parentName:"a"},"zod"))," library to define the schema of an application, inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"index.ts")," file. The ",(0,o.kt)("inlineCode",{parentName:"p"},"zod")," library is a TypeScript library that allows us to define a schema for an object, and then use the ",(0,o.kt)("inlineCode",{parentName:"p"},"z.infer")," function to infer the Typescript type of the object. This data type is stored as the ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," type, and is used throughout the application. The use of the ",(0,o.kt)("inlineCode",{parentName:"p"},"zod")," library is not mandatory, but it is recommended to use it to ensure that we can export the application state as a schema that can be used by other languages (python, c#, etc). Zod can describe most data types, including arrays, objects, tuples, unions, intersections, and more."),(0,o.kt)("p",null,"In the same file, we define the default values for the state object, which is useful for initializing the state of the application. The name of the application is also exported, and is used to identify the application instances."),(0,o.kt)("p",null,"The four values (schema, state, init and name) are mandatory and must be exported. The application generator updates the SAGE3 internal structures to include your application. The list of applications is stored in the ",(0,o.kt)("inlineCode",{parentName:"p"},"apps.json")," file, and the application values are added to the files ",(0,o.kt)("inlineCode",{parentName:"p"},"apps.ts"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"types.ts"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"initialValues.ts"),"."),(0,o.kt)("p",null,"Here is an example of the ",(0,o.kt)("inlineCode",{parentName:"p"},"index.ts")," file, for an application called ",(0,o.kt)("inlineCode",{parentName:"p"},"Counter")," with a state variable ",(0,o.kt)("inlineCode",{parentName:"p"},"count")," defined as a number with an initial value of 42:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import { z } from "zod";\n\nexport const schema = z.object({\n  count: z.number(),\n});\nexport type state = z.infer<typeof schema>;\n\nexport const init: Partial<state> = {\n  count: 42,\n};\n\nexport const name = "Counter";\n')),(0,o.kt)("p",null,"An application schema consists of the state of the application as you defined it, and several other values that are used by the SAGE3 backend to identify the application, and to position it on the board. The schema is defined as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export type AppSchema = {\n  title: string;\n  roomId: string;\n  boardId: string;\n  position: Position;\n  size: Size;\n  rotation: Rotation;\n  type: AppName;\n  state: AppState; // your application state\n  raised: boolean;\n};\n")),(0,o.kt)("p",null,"Position, Rotation and Size are defined by SAGE3 internally:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export const PositionSchema = z.object({ x: z.number(), y: z.number(), z: z.number() });\nexport const RotationSchema = z.object({ x: z.number(), y: z.number(), z: z.number() });\nexport const SizeSchema = z.object({ width: z.number(), height: z.number(), depth: z.number() });\n")),(0,o.kt)("p",null,"Each application instance is added to the SAGEBase ",(0,o.kt)("inlineCode",{parentName:"p"},"application")," collection. Every element in a SAGEBase collection also contains the following fields, added and managed by SAGE3:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export const SBSchema = z.object({\n  _id: z.string(),\n  _createdAt: z.number(),\n  _updatedAt: z.number(),\n  _updatedBy: z.string(),\n  _createdBy: z.string(),\n});\n")),(0,o.kt)("p",null,"As a developer, you can read the values of the ",(0,o.kt)("inlineCode",{parentName:"p"},"_id"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_createdAt"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_updatedAt"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_updatedBy")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"_createdBy")," fields, but you should not modify them. The ",(0,o.kt)("inlineCode",{parentName:"p"},"_id")," field is used to identify the application instance, and is used by the SAGE3 backend to identify the application instance. The ",(0,o.kt)("inlineCode",{parentName:"p"},"_createdAt"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_updatedAt"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"_updatedBy")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"_createdBy")," fields are used to track the history of the application instance, and are used by the SAGE3 backend to track the history of the application instance."),(0,o.kt)("h3",{id:"using-the-state"},"Using the state"),(0,o.kt)("p",null,"Usually, we extract the state of the application from the props at the start of each component:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"function AppComponent(props: App): JSX.Element {\n  const s = props.data.state as AppState;\n")),(0,o.kt)("p",null,"The variable ",(0,o.kt)("inlineCode",{parentName:"p"},"s")," is then used to access the application state and is typed according to your application schema. For instance in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Counter")," application, we can access the ",(0,o.kt)("inlineCode",{parentName:"p"},"count")," variable as a number as follows (you should not need to cast the type and you can inspect the type by hovering over the variable name in Visual Studio Code):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"function AppComponent(props: App): JSX.Element {\n  const s = props.data.state as AppState;\n  const count = s.count;\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"count")," variable can be used in React to define the UI of your application (both in the application window and the application toolbar). The ",(0,o.kt)("inlineCode",{parentName:"p"},"AppWindow")," component is a generic container provided by SAGE3 to handle the application window functionalities (move, resize, scale, etc). In SAGE3, we use the ",(0,o.kt)("a",{parentName:"p",href:"https://chakra-ui.com/"},"Chakra UI")," library to define the UI of the application and its styling (",(0,o.kt)("inlineCode",{parentName:"p"},"Box")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Text")," here). But any UI library can be used. Notice that we pass the state of the application as a prop to the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppWindow")," component. This is used by the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppWindow")," component to update the state of the application when the user moves, resizes, etc the application window. Also, we try to keep the application layout responsive and the font size large enough to be readable on a large screen."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'return (\n  <AppWindow app={props}>\n    <Box width="100%" height="100%" display="flex" alignItems="center" justifyContent="center">\n      <Text fontSize="5xl">Count: {count}</Text>\n    </Box>\n  </AppWindow>\n);\n')),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/5595452/225177995-a4c814e0-ebf4-4fb1-96f6-225ac680b18c.jpg",alt:"Screenshot 2023-03-14 at 6 39 12 PM"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Important: do not confuse the SAGE3 state of an application instance and a local state that you can maintain using React (with ",(0,o.kt)("inlineCode",{parentName:"p"},"useState")," > for instance). The SAGE3 state is stored in the SAGEBase ",(0,o.kt)("inlineCode",{parentName:"p"},"application")," collection and is shared by all the SAGE3 clients. The local state > is maintained by React and is not shared by the other SAGE3 clients. The SAGE3 state is updated by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"updateState")," function\nprovided by SAGE3. The local state is updated by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"useState")," function provided by React. This is particularly important when\nyou want to update the state of the application from an input element (text box, slider, etc). It is very easy to create endless cycles of > update. For instance, if you update the state of the application from an input element, the application will be re-rendered and the input > element will be updated with the new state of the application. This will trigger another update of the state of the application, and so\non. To avoid this, you should use the ",(0,o.kt)("inlineCode",{parentName:"p"},"useEffect")," hook to update the state of the application only when the value of the input element\nchanges.")),(0,o.kt)("h3",{id:"update-the-state"},"Update the state"),(0,o.kt)("p",null,"The state of the application is updated by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"updateState")," function provided by SAGE3. The ",(0,o.kt)("inlineCode",{parentName:"p"},"updateState")," function takes the ",(0,o.kt)("inlineCode",{parentName:"p"},"_id")," of the application instance, and the new state of the application. The new state is merged with the existing state of the application (specify only the variables that you want to change). The ",(0,o.kt)("inlineCode",{parentName:"p"},"updateState")," function is defined in the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppStore")," and can be accessed as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"const updateState = useAppStore((state) => state.updateState);\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"AppStore")," will handle the communication with the SAGE3 backend to update the state of the application and all the clients will receive the update automatically. React will then re-render the application window and the toolbar."),(0,o.kt)("p",null,"For instance, in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Counter")," application, we can update the ",(0,o.kt)("inlineCode",{parentName:"p"},"count")," variable as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"const handleSubClick = () => {\n  updateState(props.data._id, { count: s.count - 1 });\n};\n")),(0,o.kt)("p",null,"To initialize your application when it starts, you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"useEffect")," React hook with an empty dependency array:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"  useEffect(() => {\n    // The application has started\n    ...\n  }, []);\n")),(0,o.kt)("p",null,"To respond to state value change, you can use ",(0,o.kt)("inlineCode",{parentName:"p"},"useEffect")," React hook:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"}," useEffect(() => {\n  // The assetid has changed\n  ...\n  }, [props.data.state.assetid])\n")),(0,o.kt)("h3",{id:"toolbar"},"Toolbar"),(0,o.kt)("p",null,"You can decide to put some of the UI of your application in the toolbar. Usually we only keep the most used functions in the toolbar. The rest of the UI can be rendered inside the application window. It is up to you. We usually only put a few buttons in the toolbar. The toolbar is displayed below the application window when the application is selected by the user. A few buttons are added automatically by SAGE3 to handle the application window functionalities (move, resize, scale, etc). The toolbar component is defined as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'function ToolbarComponent(props: App): JSX.Element {\n  const s = props.data.state as AppState;\n\n  const handleSubClick = () => { ... };\n  const handleAddClick = () => { ... };\n\n  return (\n    <ButtonGroup isAttached size="xs" colorScheme="teal">\n      <Tooltip placement="top-start" hasArrow={true} label={\'Decrease Count\'} openDelay={400}>\n        <Button onClick={handleSubClick} colorScheme="red">\n          <MdRemove />\n        </Button>\n      </Tooltip>\n      <Tooltip placement="top-start" hasArrow={true} label={\'Increase Count\'} openDelay={400}>\n        <Button onClick={handleAddClick}>\n          <MdAdd />\n        </Button>\n      </Tooltip>\n    </ButtonGroup>\n  );\n}\n')),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/5595452/225178055-dd01c80a-b371-415e-87de-477457625c14.jpg",alt:"Screenshot 2023-03-14 at 6 40 12 PM"})),(0,o.kt)("h2",{id:"data-stores"},"Data Stores"),(0,o.kt)("p",null,"We defined a series of data stores to handle most the the collections in the SAGEBase database. The data stores are defined in the ",(0,o.kt)("inlineCode",{parentName:"p"},"webstack/libs/frontend/src/lib/stores")," folder. The data stores are used to access the data in the SAGEBase database and do not contain any React component (pure Typescript files)."),(0,o.kt)("p",null,"The data stores list contains the following stores:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"AppStore")," to access the application collection: contains the list of apps and functions to operate on the apps:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"create")," to create a new app"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"update")," to resize, move, scale, etc an app"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"delete")," to delete an app"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"updateState")," to update directly the state of an app"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"duplicateApps")," to duplicate a list of app instances"),(0,o.kt)("li",{parentName:"ul"},"a few more internal functions"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"RoomStore")," to access the room collection: list all the rooms and ",(0,o.kt)("inlineCode",{parentName:"li"},"create"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"update"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"delete")," functions"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"BoardStore")," to access the board collection: list all the boards and ",(0,o.kt)("inlineCode",{parentName:"li"},"create"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"update"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"delete")," functions"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"UIStore")," to access the UI of the current board: large collection of values such as scale and size of the board, the current board position, selected apps, and UI controls."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"AssetStore")," to access all the assets managed in SAGE3: application receiving an ",(0,o.kt)("inlineCode",{parentName:"li"},"asset id")," can retrieve all the information about the asset (name, type, url, etc)."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"UsersStore")," to access the user collection: list all the registered users and their settings (full name, nickname, profile, role, type),"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"PresenceStore")," to access the presence collection: list all the currently active users and their settings (current board, cursor position, viewport, etc)."),(0,o.kt)("li",{parentName:"ul"},"SAGE3 internal collections: plugin, twilio, panel, message, etc.")),(0,o.kt)("p",null,"Follows the description of a few common operations exposed by the application, UI, and asset stores."),(0,o.kt)("h3",{id:"application-store"},"Application Store"),(0,o.kt)("p",null,"We saw previously how to update the state of an application. Another very common operation is to create a new application instance. The ",(0,o.kt)("inlineCode",{parentName:"p"},"create")," function of the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppStore")," handles that. For instance, you might want to create a stickie note next to an application or to open a webview to show web content."),(0,o.kt)("p",null,"First, retrieve the ",(0,o.kt)("inlineCode",{parentName:"p"},"create")," function from the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppStore"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"const createApp = useAppStore((state) => state.create);\n")),(0,o.kt)("p",null,"Then, call the ",(0,o.kt)("inlineCode",{parentName:"p"},"createApp")," function with the appropriate parameters (refer to the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppSchema")," to know the list of values that can be passed). For instance, to create a new stickie note::"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"    // Get information about the current application\n    const state = props.data.state as AppState;\n    const pos = props.data.position;\n    const size = props.data.size;\n\n    // Create a new stickie note next to the current application (same room and board and color)\n    createApp({\n      title: 'My new stickie',\n      roomId: props.roomId,\n      boardId: props.roomId,\n      position: { x: pos.x + size.width + 20, y: pos.y, z: 0 },\n      size: { width: size.width, height: size.height, depth: 0 },\n      rotation: { x: 0, y: 0, z: 0 },\n      type: 'Stickie',\n      state: { text: 'Some Text', color: state.color},\n      raised: true,\n    });\n")),(0,o.kt)("h3",{id:"uistore-store"},"UIStore Store"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"UIStore")," contains a large collection of values that are used to control the UI of the applications and the current board. The ",(0,o.kt)("inlineCode",{parentName:"p"},"UIStore")," is used by many internal components, including the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppWindow")," component to render the application windows and the toolbars."),(0,o.kt)("p",null,"The UIStore is defined in ",(0,o.kt)("inlineCode",{parentName:"p"},"webstack/libs/frontend/src/lib/stores/ui.ts"),". It contains:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"scale, size, z-index, and position of the board"),(0,o.kt)("li",{parentName:"ul"},"UI settings: show/hide the UI, show/hide the app title, lock the board, etc"),(0,o.kt)("li",{parentName:"ul"},"Whiteboard settings: whiteboard mode, clear markers, clear all markers, marker color, etc"),(0,o.kt)("li",{parentName:"ul"},"Lasso settings: selected apps, lasso mode, lasso selection, lasso selection rectangle, etc"),(0,o.kt)("li",{parentName:"ul"},"Toolbar and context menu positions"),(0,o.kt)("li",{parentName:"ul"},"etc")),(0,o.kt)("p",null,"For instance:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"  // Retrieve the scale of the board (scale: number)\n  const scale = useUIStore((state) => state.scale);\n  // Get the current board current position (x: number, y:number)\n  const boardPosition = useUIStore((state) => state.boardPosition);\n")),(0,o.kt)("h3",{id:"asset-store"},"Asset Store"),(0,o.kt)("p",null,"Get all the assets:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"  // Get all the assets: (assets: Asset[])\n  const assets = useAssetStore((state) => state.assets);\n")),(0,o.kt)("p",null,"The asset schema is defined as follow:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"const schema = z.object({\n  file: z.string(),\n  owner: z.string(),\n  room: z.string(),\n  originalfilename: z.string(),\n  path: z.string(),\n  dateCreated: z.string(),\n  dateAdded: z.string(),\n  mimetype: z.string(),\n  destination: z.string(),\n  size: z.number(),\n  metadata: z.string().optional(),\n  derived: z.union([ExtraImageSchema, ExtraPDFSchema]).optional(),\n});\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"file: unique filename based on a UUID"),(0,o.kt)("li",{parentName:"ul"},"owner: who uploaded the file"),(0,o.kt)("li",{parentName:"ul"},"room: upload room"),(0,o.kt)("li",{parentName:"ul"},"originalfilename: filename at upload time"),(0,o.kt)("li",{parentName:"ul"},"path: directory"),(0,o.kt)("li",{parentName:"ul"},"dateCreated, dateAdded: dates"),(0,o.kt)("li",{parentName:"ul"},"mimetype: file type in mime standard"),(0,o.kt)("li",{parentName:"ul"},"destination: folder"),(0,o.kt)("li",{parentName:"ul"},"size: size in bytes"),(0,o.kt)("li",{parentName:"ul"},"metadata: contains the name of the JSON metadata file in the server. The data is extracted with ",(0,o.kt)("inlineCode",{parentName:"li"},"EXIFTool")," after upload."),(0,o.kt)("li",{parentName:"ul"},"derived: contains either data for the ImageViewer or the PDFViewer application.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// information for derived images\nexport const ExtraImageSchema = z.object({\n  fullSize: z.string(),\n  width: z.number(),\n  height: z.number(),\n  aspectRatio: z.number(),\n  filename: z.string(),\n  url: z.string(),\n  sizes: z.array(ImageInfoSchema), // multiple resolutions\n});\n\n// Each image resolution\nexport const ImageInfoSchema = z.object({\n  url: z.string(),\n  format: z.string(),\n  size: z.number(),\n  width: z.number(),\n  height: z.number(),\n  channels: z.number(),\n  premultiplied: z.boolean(),\n});\n\n// Information for PDF file: array of pages with array of images (each page at multiple resolutions)\nexport const ExtraPDFSchema = z.array(z.array(ImageInfoSchema));\n")))}d.isMDXComponent=!0}}]);