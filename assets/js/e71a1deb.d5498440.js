"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8815],{5962:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Server-Deployment","title":"Server Deployment","description":"Updated January 2025","source":"@site/docs/Server-Deployment.md","sourceDirName":".","slug":"/Server-Deployment","permalink":"/docs/Server-Deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Server-Deployment.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11},"sidebar":"tutorialSidebar","previous":{"title":"SAGE3 API in SageCell","permalink":"/docs/SAGE3-API-in-SageCell"},"next":{"title":"SAGE3 Server Update v1.3 - v1.4","permalink":"/docs/Server-update"}}');var r=s(4848),o=s(8453);const t={sidebar_position:11},l="Server Deployment",a={},c=[{value:"Requirements",id:"requirements",level:2},{value:"Installation",id:"installation",level:2},{value:"Linux",id:"linux",level:3},{value:"Windows",id:"windows",level:3},{value:"MacOS",id:"macos",level:3},{value:"Configuration",id:"configuration",level:2},{value:"AI Configuration",id:"ai-configuration",level:3},{value:"Status and problem solving",id:"status-and-problem-solving",level:3},{value:"Services",id:"services",level:2},{value:"Google Login",id:"google-login",level:3},{value:"Apple Login",id:"apple-login",level:3},{value:"CILogon",id:"cilogon",level:3},{value:"Twilio",id:"twilio",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"server-deployment",children:"Server Deployment"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Updated January 2025"})}),"\n",(0,r.jsx)(n.p,{children:"The SAGE3 server can be deployed on a Window, Mac or Linux machine with a fully qualified name and a SSL certificate to support HTTPS. It includes a series of containers running the services required for the SAGE3 platform (using docker compose)."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["For reference, SAGE3 is composed of","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"`redis-server`: in-memory database"}),"\n",(0,r.jsx)(n.li,{children:"`node-server`: web server"}),"\n",(0,r.jsx)(n.li,{children:"`fluentd-server`: logging server"}),"\n",(0,r.jsx)(n.li,{children:"`kernelserver`: jupyter kernel management"}),"\n",(0,r.jsx)(n.li,{children:"`jupyter`: jupyter server"}),"\n",(0,r.jsx)(n.li,{children:"`chromadb`: Vector database for AI services"}),"\n",(0,r.jsx)(n.li,{children:"`seer`: Python backend for AI services"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"To update a server, here are the files to keep/move/backup:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Your assets (images, PDF, movies, \u2026) are in the ",(0,r.jsx)(n.code,{children:"configurations/node/assets"})," sub folder.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Files to save if you want to backup your server."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Your plugins are in the ",(0,r.jsx)(n.code,{children:"configurations/node/plugins"})," sub folder.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Files to save if you want to backup your server."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["The database data (rooms, boards, users, \u2026) is in ",(0,r.jsx)(n.code,{children:"configurations/redis/data/dump.rdb"})," file","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"File to save if you want to backup your server."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Windows, MacOS, or Linux operating system"}),"\n",(0,r.jsx)(n.li,{children:"Docker installation"}),"\n",(0,r.jsxs)(n.li,{children:["Fully Qualified Domain Name (FQDN)","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["i.e. A hostname recognized on a public network or your institutions private network","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ex. myserver.mycompany.com"}),"\n",(0,r.jsx)(n.li,{children:"Ex. myserver.cs.university.edu"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"SSL Certificates for server (or wildcard certificate for a domain)"}),"\n",(0,r.jsxs)(n.li,{children:["Optional services:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Google OAuth credentials, for authentication"}),"\n",(0,r.jsx)(n.li,{children:"CILogin OAuth credentials, for authentication"}),"\n",(0,r.jsx)(n.li,{children:"Apple with 'Sign in with Apple' credentials, for authentication"}),"\n",(0,r.jsx)(n.li,{children:"Twilio API registration, for screen sharing"}),"\n",(0,r.jsx)(n.li,{children:"OpenAI API key, for AI services"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.p,{children:"Linux is the main platform for SAGE3 production deployment. MacOS and Windows are supported for development and testing. The following instructions are for Linux, MacOS, and Windows."}),"\n",(0,r.jsx)(n.h3,{id:"linux",children:"Linux"}),"\n",(0,r.jsx)(n.p,{children:"We are mostly using Ubuntu, but the instructions should be similar for other distributions."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Install Docker for ubuntu"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Do not install ",(0,r.jsx)(n.code,{children:"Docker Desktop"})," for Ubuntu. Instead, install ",(0,r.jsx)(n.code,{children:"Docker Engine"})," for Ubuntu"]}),"\n",(0,r.jsxs)(n.li,{children:["Have a ",(0,r.jsx)(n.code,{children:"sudo"})," capable user account (not root)"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Install docker\nsudo apt-get install docker.io docker-compose-plugin\n\n# Add the user to the docker group\nsudo usermod -aG docker [username]\n\n# Create the new group\nnewgrp docker\n\n# Close terminal and open a new one\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Test docker installation"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Check docker status\ndocker ps\nCONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES\n\n# Run the test container hello-world\ndocker run --rm hello-world\n\n# It pulls hello-world image\n# It runs the image\n# It deletes the container after it is done\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Install NodeJS 20.xx"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Installation using NodeSource repository"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\ncurl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -\nsudo apt-get install -y nodejs\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Test NodeJS installation"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\nnode -v\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Download a SAGE3 server package:"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/SAGE-3/next/releases/download/server-1.4/SAGE3-1.4-linux-amd64.tgz",children:"SAGE3 Linux AMD64 Server Package for Intel CPUs"})," and extract it."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Move the downloaded file to your user's home folder\nmv SAGE3-1.4-linux-amd64.tgz ~\ncd ~\n\n# Extract file\ntar xvfz SAGE3-1.4-linux-amd64.tgz\ncd SAGE3-1.4\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Copy your SSL Certificates to the configurations folder. There should be two files, your PRIVATE key and the CERTIFICATE file"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Copy SSL Certs to the SAGE3 Keys folder. Remember these names for later when setting up the configuration file (step 7).\ncp PRIVATE_KEY_FILE ~/SAGE3-1.4/configurations/node/keys\ncp CERTIFICATE_FILE ~/SAGE3-1.4/configurations/node/keys\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Generate JWT Keys and Token"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Switch to the SAGE3 Node Keys Directory\ncd ~/SAGE3-1.4/configurations/node/keys\n\n# Generate JWT Keys and Token\n./genJWT_keys.sh\n./genJWT_token.sh\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsxs)(n.li,{children:["Edit the ",(0,r.jsx)(n.code,{children:".env"})," File"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Change directory to the SAGE3 Server Folder\ncd ~/SAGE3-1.4\n\n# Edit .env file and add the name of your server and the token you just generated. Leave other variables as is.\nvim .env\nSAGE3_SERVER=YOUR_SERVERS_HOST_NAME\nTOKEN= # token value copied without \u201c\u201d from: configurations/node/keys/token.json\nCHROMA_SERVER_AUTHN_CREDENTIALS=...\nCHROMA_CLIENT_AUTH_CREDENTIALS=...\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsxs)(n.li,{children:["Edit the Configuration file ",(0,r.jsx)(n.code,{children:"sage3-prod.hjson"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Change directory to the SAGE3 Server Node Folder\ncd ~/SAGE3-1.4/configurations\n\n# Edit the sage3-prod.hjson file with your preferred editor\n# The file is documented with instructions.\nvim sage3-prod.hjson\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"9",children:["\n",(0,r.jsx)(n.li,{children:"Pull the Docker Images"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Change to the SAGE3 Server Directory\ncd ~/SAGE3-1.4\n\n# Pull images\ndocker compose pull\n\n# Might take a while but results should be:\n \u2714 redis-server Pulled                                                                            0.3s \n \u2714 node-server Pulled                                                                             0.3s \n \u2714 seer Pulled                                                                                    0.3s \n \u2714 fluentd-server Pulled                                                                          0.3s \n \u2714 jupyter Pulled                                                                                 1.1s \n \u2714 chromadb Pulled                                                                                0.3s \n \u2714 kernelserver Pulled                                                                            0.2s \n"})}),"\n",(0,r.jsxs)(n.ol,{start:"10",children:["\n",(0,r.jsx)(n.li,{children:"Start the Server"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Open a Terminal\n\n# Change to the SAGE3 Server Directory\ncd ~/SAGE3-1.4\n\n# Start Server\n./GO\n\n# To Stop the Server\n./STOP\n"})}),"\n",(0,r.jsx)(n.h3,{id:"windows",children:"Windows"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Install ",(0,r.jsx)(n.a,{href:"https://www.docker.com/products/docker-desktop/",children:"Docker Desktop for Windows"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Install Windows Subsystem for Linux WSL using distribution Ubuntu 22.04"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell\nwsl --install -d Ubuntu-22.04\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["(optional) You can install ",(0,r.jsx)(n.a,{href:"https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl",children:"Visual Studio Code WSL Extension"})," to edit files inside WSL."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Install Node.js within the WSL subsystem"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Ensure Curl is installed\nsudo apt-get install curl\n\n# Install Node.js repository\ncurl -sL https://deb.nodesource.com/setup_20.x | sudo -E bash -\n# Install Node.js\nsudo apt-get install -y nodejs\n# Test\nnode -v\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["Download the ",(0,r.jsx)(n.a,{href:"https://github.com/SAGE-3/next/releases/download/server-1.4/SAGE3-1.4-linux-amd64.tgz",children:"SAGE3 Linux AMD64 Server Package"})," and extract it within the WSL subsystem"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Download the file if not done already\ncurl -LJO https://github.com/SAGE-3/next/releases/download/server-1.4/SAGE3-1.4-linux-amd64.tgz\n\n# Move the downloaded file to your user's home folder\nmv SAGE3-1.4-linux-amd64.tgz ~\ncd ~\n\n# Extract file\ntar xvfz SAGE3-1.4-linux-amd64.tgz\ncd SAGE3-1.4\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Copy your SSL Certificates to the configurations folder. There should be two files, your PRIVATE key and the CERTIFICATE file"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Copy SSL Certs to the SAGE3 Keys folder. Remember these names for later when setting up the configuration file (step 8).\ncp PRIVATE_KEY_FILE ~/SAGE3-1.4/configurations/node/keys\ncp CERTIFICATE_FILE ~/SAGE3-1.4/configurations/node/keys\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsx)(n.li,{children:"Generate JWT Keys and Token"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Switch to the SAGE3 Node Keys Directory\ncd ~/SAGE3-1.4/configurations/node/keys\n\n# Generate JWT Keys and Token\n./genJWT_keys.sh\n./genJWT_token.sh\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsxs)(n.li,{children:["Edit the ",(0,r.jsx)(n.code,{children:".env"})," File"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Change directory to the SAGE3 Server Folder\ncd ~/SAGE3-1.4\n\n# Edit .env file with your preferred editor\nvim .env\nSAGE3_SERVER=YOUR_SERVERS_HOST_NAME\nTOKEN= # token value copied without \u201c\u201d from: configurations/node/keys/token.json\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"8",children:["\n",(0,r.jsxs)(n.li,{children:["Edit the Configuration file ",(0,r.jsx)(n.code,{children:"sage3-prod.hjson"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Change directory to the SAGE3 Server Node Folder\ncd ~/SAGE3-1.4/configurations/node\n\n# Edit the sage3-prod.hjson file with your preferred editor\n# The file is documented with instructions.\nvim sage3-prod.hjson\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"9",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Start Docker Desktop within Windows"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Pull the Docker Images"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Change to the SAGE3 Server Directory\ncd ~/SAGE3-1.4\n\n# Pull images\nsudo docker compose pull\n\n# Might take a while but the results should be similar to:\nPulling redis-server ... done\nPulling node-server  ... done\nPulling python       ... done\nPulling jupyter      ... done\nPulling fluentd      ... done\npulling fastapi      ... done\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"11",children:["\n",(0,r.jsx)(n.li,{children:"Start the Server"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open Powershell and switch to WSL\nwsl\n\n# Change to the SAGE3 Server Directory\ncd ~/SAGE3-1.4\n\n# Start Server\n./GO\n\n# To Stop the Server\n./STOP\n"})}),"\n",(0,r.jsx)(n.h3,{id:"macos",children:"MacOS"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Install ",(0,r.jsx)(n.a,{href:"https://www.docker.com/products/docker-desktop/",children:"Docker Desktop for macOS"})]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Make sure to select the architecture (M1 or Intel) that matches your machine"}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Install NodeJS 20.xx"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Navigate to ",(0,r.jsx)(n.a,{href:"https://nodejs.org/en/download/",children:"NodeJS Downloads"})," and download the latest v20.x of NodeJS for your machine"]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Download a SAGE3 server package:"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/SAGE-3/next/releases/download/server-1.4/SAGE3-1.4-macos-arm64.tgz",children:"SAGE3 macOS ARM64 Server Package for Arm CPUs"})," and extract it"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/SAGE-3/next/releases/download/server-1.4/SAGE3-1.4-linux-amd64.tgz",children:"SAGE3 Linux AMD64 Server Package for Intel CPUs"})," and extract it"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Move the downloaded file to your user's home folder\nmv SAGE3-1.4-linux-arm64.tgz ~\ncd ~\n\n# Extract file\ntar xvfz SAGE3-1.4-linux-arm64.tgz\ncd SAGE3-1.4\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Copy your SSL Certificates to the configurations folder. There should be two files, your PRIVATE key and the CERTIFICATE file"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Copy SSL Certs to the SAGE3 Keys folder. Remember these names for later when setting up the configuration file (step 7).\ncp PRIVATE_KEY_FILE ~/SAGE3-1.4/configurations/node/keys\ncp CERTIFICATE_FILE ~/SAGE3-1.4/configurations/node/keys\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Generate JWT Keys and Token"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Switch to the SAGE3 Node Keys Directory\ncd ~/SAGE3-1.4/configurations/node/keys\n\n# Generate JWT Keys and Token\n./genJWT_keys.sh\n./genJWT_token.sh\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsxs)(n.li,{children:["Edit the ",(0,r.jsx)(n.code,{children:".env"})," File"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Change directory to the SAGE3 Server Folder\ncd ~/SAGE3-1.4\n\n# Edit .env file with your preferred editor\nvim .env\nSAGE3_SERVER=YOUR_SERVERS_HOST_NAME\nTOKEN= # token value copied without \u201c\u201d from: configurations/node/keys/token.json\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsxs)(n.li,{children:["Edit the Configuration file ",(0,r.jsx)(n.code,{children:"sage3-prod.hjson"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Change directory to the SAGE3 Server Node Folder\ncd ~/SAGE3-1.4/configurations\n\n# Edit the sage3-prod.hjson file with your preferred editor\n# The file is documented with instructions.\nvim sage3-prod.hjson\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"8",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Start Docker Desktop for macOS"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Pull the Docker Images"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Change to the SAGE3 Server Directory\ncd ~/SAGE3-1.4\n\n# Pull images\ndocker compose pull\n\n# Might take a while but the results should be similar to:\n \u2714 redis-server Pulled                                                                            0.3s \n \u2714 node-server Pulled                                                                             0.3s \n \u2714 seer Pulled                                                                                    0.3s \n \u2714 fluentd-server Pulled                                                                          0.3s \n \u2714 jupyter Pulled                                                                                 1.1s \n \u2714 chromadb Pulled                                                                                0.3s \n \u2714 kernelserver Pulled                                                                            0.2s \n"})}),"\n",(0,r.jsxs)(n.ol,{start:"10",children:["\n",(0,r.jsx)(n.li,{children:"Start the Server"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Open a Terminal\n\n# Change to the SAGE3 Server Directory\ncd ~/SAGE3-1.4\n\n# Start Server\n./GO\n\n# To Stop the Server\n./STOP\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The server configuration file is located here: ",(0,r.jsx)(n.code,{children:"/configurations/node/sage3-prod.hjson"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"This is a JSON file that support comments and slightly more relaxed syntax.\nMake sure to stop the server (./STOP) before editing the file, and restart the server afterwards (./GO)"}),"\n",(0,r.jsx)(n.p,{children:"This file allows you to configure your server to your specific needs."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n   // Is the server in production mode.\n   // Leave as true if you are deploying your server.\n  "production": true,\n\n   // Name of the server to show in the UI\n  "serverName": "My Local Server",\n\n  // HTTP Settings\n  "port": 443,\n  "tlsVersion": "TLSv1.2",\n\n  // SSL Certificate names\n  "ssl": {\n    // Located in the `/configurations/node/keys\' folder\n    "certificateFile": "localhost-server.crt",\n    "certificateKeyFile": "localhost-server.key"\n  },\n\n  // These can be left alone, they are used to find the assets\n  "root": ".",\n  "public": "dist/apps/homebase/assets",\n  "assets": "dist/apps/webapp/assets/",\n\n  // Redis Database Config\n  "redis": {\n    // The Redis Database URL.\n    // If using the default deployment, leave as such.\n    "url": "redis://redis-server:6379"\n  },\n\n  // Fluentd log configuration\n  "fluentd": {\n    "server": "fluentd-server",\n    "port": 24224,\n    "databaseLevel": "partial" // all | partial | none\n  },\n\n  // Webserver configuration\n  "webserver": {\n    "logLevel": "all", // all | partial | none,\n    "uploadLimit": "5GB" // file upload size limit in string, optional units: KB, MB, GB, TB\n  },\n\n  // Fastapi python server for kernels\n  "kernels": {\n    "url": "http://kernelserver:8000"\n  },\n  // Fastapi python server for agents\n  "agents": {\n    "url": "http://seer:9999"\n  },\n\n  // Feedback URL\n  "feedback": {\n    "url": "http://sage3-server-status.cis230038.projects.jetstream-cloud.org:3000/feedback"\n  },\n\n // External Services\n "services": {\n    // To enable screen sharing you must register for a Twilio account.\n    // Video Rooms is the Twilio feature we use for ScreenSharing.\n    // After setting this, ensure \'Screenshare\' is in the \'features.apps` array.\n    twilio: {\n      // Your Account SID from www.twilio.com/console\n      accountSid: "",\n      // API Key.\n      apiKey: "",\n      // API Secret\n      apiSecret: ""\n    },\n    "openai": {\n      // API Key\n      "apiKey": "",\n      // Model name: gpt-3.5-turbo, gpt-4, gpt-4o-mini, ...\n      "model": "gpt-4o-mini"\n    },\n    "llama": {\n      "url": "https://arcade.evl.uic.edu/llama32-11B-vision",\n      "model": "meta/llama-3.2-11b-vision-instruct",\n      "apiKey": "",\n      "max_tokens": 1000\n    },\n    "codellama": {\n      "url": "https://arcade.evl.uic.edu/codellama",\n      "apiKey": "",\n      "max_tokens": 400\n    },\n    "yolo": {\n      "url": "https://arcade.evl.uic.edu/yolov8",\n      "apiKey": ""\n    }\n  },\n\n  // How to enable/disable some features for safety\n  "features": {\n    // Enable Plugins. Allows uploading of Webapps.\n    plugins: true,\n    // Which Apps to enable.  Available Apps:\n    apps: ["Chat", "CodeEditor", "MapGL", "Notepad", "SageCell", "Stickie", "Screenshare", "Webview", "Poll", "TLDraw", "Calculator", "Hawaii Mesonet"]\n  },\n\n  // Auth Configuration\n  "auth": {\n    // Secret HASH for the sessions. Change this to something unique.\n    "sessionSecret": "SUPERSECRET!!$$",\n    // Max age for a session per user. In milliseconds. 7 days\n    "sessionMaxAge": 604800000,\n    // Which login strategies to enable for the server.\n    // If you enbable them ensure you add the relevant config information below.\n    "strategies": [\n      "google",\n      "apple",\n      "cilogon",\n      "guest",\n      "spectator",\n      "jwt"\n    ],\n    // A List of emails to enable those users to be admins.\n    // This will enable a ADMIN page for these users.\n    "admins": [ "toto@example.com", "john@google.com" ],\n    // Guest configuration\n    "guestConfig": {\n      // Endpoint for the guest login. No need to change this\n      "routeEndpoint": "/auth/guest"\n    },\n    // Spectator configuration\n    "spectatorConfig": {\n      // Endpoint for the spectator login. No need to change this\n      "routeEndpoint": "/auth/spectator"\n    },\n    // Google configuration\n    "googleConfig": {\n      // Client ID from the Google Developer Console\n      "clientID": "",\n      // Client Secret from the Google Developer Console\n      "clientSecret": "",\n      // Endpoint for the google login\n      "routeEndpoint": "/auth/google",\n      // Callback URL for the google login\n      "callbackURL": "/auth/google/redirect"\n    },\n    // Apple configuration\n    "appleConfig": {\n      // It is the service id name\n      "clientID": "",\n      // Your Apple developer team ID\n      "teamID": "",\n      // Key ID\n      "keyID": "",\n      // Private key file location\n      "privateKeyLocation": "./keys/apple-key.p8",\n      "callbackURL": "/auth/apple/redirect",\n      "routeEndpoint": "/auth/apple"\n    },\n    // JWT configuration\n    "jwtConfig": {\n      // The issuer of the JWT\n      "issuer": "sage3app@gmail.com",\n      // The audience of the JWT\n      "audience": "sage3.app",\n      // Public key location. Leave this alone\n      "publicKey": "./keys/jwt_public.pem",\n      // JWT Route endpoint\n      "routeEndpoint": "/auth/jwt"\n    },\n    // CILogon configuration\n    "cilogonConfig": {\n      // Client ID from CILogon\n      "clientID": "",\n      // Client Secret from CILogon\n      "clientSecret": "",\n      // Endpoint for the cilogon login\n      "routeEndpoint": "/auth/cilogon",\n      // Callback URL for the cilogon login\n      "callbackURL": "/auth/cilogon/redirect"\n    }\n  },\n  // Namespace for signing UUID v5 keys: generate yours or https://www.uuidtools.com/generate/v4\n  "namespace": "XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"ai-configuration",children:"AI Configuration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Put your OpenAI key to be used on your server. You can create a key and allocate a budget at (OpenAI)[",(0,r.jsx)(n.a,{href:"https://platform.openai.com/api-keys",children:"https://platform.openai.com/api-keys"}),"]."]}),"\n",(0,r.jsx)(n.li,{children:"You can use any of the OpenAI models available. The model name can be found at the OpenAI website."}),"\n",(0,r.jsx)(n.li,{children:"When processing PDF files, we use the OpenAI embedded model. PDF analysis might not work without an OpenAI key at this time (January 2025)."}),"\n",(0,r.jsx)(n.li,{children:"The Llama model is hosted at the University of Illinois at Chicago. You can use the model without an API key."}),"\n",(0,r.jsx)(n.li,{children:"To disable AI, leave the openai apiKey empty and leave the llama url empty."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'    "openai": {\n      // API Key\n      "apiKey": "",\n      // Model name: gpt-3.5-turbo, gpt-4, gpt-4o-mini, ...\n      "model": "gpt-4o-mini"\n    },\n    "llama": {\n      "url": "https://arcade.evl.uic.edu/llama32-11B-vision",\n      "model": "meta/llama-3.2-11b-vision-instruct",\n      "apiKey": "",\n      "max_tokens": 1000\n    },\n'})}),"\n",(0,r.jsx)(n.h3,{id:"status-and-problem-solving",children:"Status and problem solving"}),"\n",(0,r.jsxs)(n.p,{children:["To check if the state of the system, you can use ",(0,r.jsx)(n.code,{children:"docker"})," commands:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"List the docker images present on the system:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"> docker images\nREPOSITORY                     TAG       IMAGE ID       CREATED        SIZE\nREPOSITORY                             TAG               IMAGE ID       CREATED        SIZE\nghcr.io/sage-3/agents                  dev_arm64         ffaf2a339c7b   22 hours ago   3.73GB\nghcr.io/sage-3/next                    dev_arm64         1305e9592af5   22 hours ago   2.14GB\nfluent/fluentd                         edge-debian       899f6c4f419f   5 weeks ago    235MB\nchromadb/chroma                        0.5.16            ec7fe55aac18   2 months ago   479MB\nredis/redis-stack-server               latest            a5ac850ed6cb   3 months ago   403MB\nghcr.io/sage-3/sagekernelserver        arm64             324f16bba2e9   6 months ago   1.07GB\nquay.io/jupyter/datascience-notebook   2024-05-27        0752ac24b52d   7 months ago   5.53GB\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check system status"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'> docker ps\nCONTAINER ID   IMAGE                             COMMAND                  CREATED        STATUS                  PORTS                      NAMES\n20a136469e25   ghcr.io/sage-3/sagekernelserver:arm64             "python src/main.py \u2026"   22 hours ago   Up 22 hours (healthy)   127.0.0.1:8000->8000/tcp               sage3-10-kernelserver-1\nb93c18e46325   d5df36d8db59                                      "docker-entrypoint.s\u2026"   22 hours ago   Up 22 hours (healthy)   0.0.0.0:443->443/tcp                   sage3-10-node-server-1\ne3a6448d6df2   7fc39679f348                                      "fastapi run main.py\u2026"   22 hours ago   Up 22 hours (healthy)   127.0.0.1:9999->9999/tcp               sage3-10-seer-1\n5bc7b93c6bf5   quay.io/jupyter/datascience-notebook:2024-05-27   "tini -g -- start.sh\u2026"   22 hours ago   Up 22 hours (healthy)   127.0.0.1:8888->8888/tcp               sage3-10-jupyter-1\nb6a3ae3c7244   chromadb/chroma:0.5.16                            "/docker_entrypoint.\u2026"   22 hours ago   Up 22 hours (healthy)   127.0.0.1:8100->8000/tcp               sage3-10-chromadb-1\n4776cdcfedf9   redis/redis-stack-server:latest                   "redis-server /conf/\u2026"   22 hours ago   Up 22 hours             127.0.0.1:6379->6379/tcp               sage3-10-redis-server-1\nb2d60836dee3   fluent/fluentd:edge-debian                        "tini -- /bin/entryp\u2026"   22 hours ago   Up 22 hours             5140/tcp, 127.0.0.1:24224->24224/tcp   sage3-10-fluentd-server-1\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"See logs of a container"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"> docker logs sage3-10-node-server-1\nMode> production\nHTTPS> listening on port 443\nGoogle Login> Setup done\nApple Login> Setup done\nJWT> Login setup done\nGuest Login> Setup done\nCILogon Login> Setup done\n...\n"})}),"\n",(0,r.jsx)(n.h2,{id:"services",children:"Services"}),"\n",(0,r.jsx)(n.h3,{id:"google-login",children:"Google Login"}),"\n",(0,r.jsx)(n.p,{children:"To enable Google Login for users from the Login page you must setup a Google Cloud account. Google OAuth is a free service that allows users to sign into SAGE3 with their Google Accounts."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Login to your Google account from the ",(0,r.jsx)(n.a,{href:"https://cloud.google.com/",children:"Google Cloud Platform"})," website."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.code,{children:"Console"})," in the upper right corner."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220174990-6c6e0403-c080-4b01-97dd-c276bdfc7caf.png",alt:"arch-detailed",height:"100"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["Create a ",(0,r.jsx)(n.code,{children:"New Project"})," from the ",(0,r.jsx)(n.code,{children:"Manage Resources"})," page. Can be found using the search box at the top of the page."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220175501-4015e780-f944-446f-bc14-d20bdeea2016.png",height:"100"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.code,{children:"CREATE PROJECT"}),"."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220175717-04355645-d9ce-47de-bc9b-6d504fc5cc31.png",height:"100"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:["Enter the information and click ",(0,r.jsx)(n.code,{children:"Create"}),". (The information here is just organization/hierarchy information.) It might take a few minutes for it to be created."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220175865-9d8460a5-eefc-40c1-93b2-7425c2c92511.png",height:"320"}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Go back to the homepage by clicking the Google Cloud icon in the upper left corner."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"From the drop down menu at the top of the page select your newly created project."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220176270-a99e4da6-95c1-487d-8095-8b5a8f5db6e0.png",height:"50"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"8",children:["\n",(0,r.jsxs)(n.li,{children:["Open the ",(0,r.jsx)(n.code,{children:"Credentials"})," page from the main dropdown menu."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220176765-5e054ba4-9eb2-485e-a4ad-6cb38f517ab2.png",height:"300"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"9",children:["\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.code,{children:"Create Credentials"})," and select ",(0,r.jsx)(n.code,{children:"OAuth client ID"})]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220177297-d41bb7a5-9d9d-41c3-8910-50a77e5cba3b.png",height:"320"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"10",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["If it requests to ",(0,r.jsx)(n.code,{children:"Configure Consent Screen"})," click the button. If not continue to step 15."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"OAuth Consent Screen. Select External and click create. Enter the information below. All the other fields can be left blank."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"App name:"})," The Name of the SAGE3 Server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User support email:"})," The email of the person managing your SAGE3 server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authorized Domain:"})," The ",(0,r.jsx)(n.code,{children:"domain"})," of your SAGE3 Server. (Ex. For ",(0,r.jsx)(n.code,{children:"https://sage3.manoa.hawaii.edu"})," it is ",(0,r.jsx)(n.code,{children:"hawaii.edu"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Developer contact information:"})," The email of the person managing your SAGE3 server."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"12",children:["\n",(0,r.jsxs)(n.li,{children:["Scopes. Click ",(0,r.jsx)(n.code,{children:"ADD OR REMOVE SCOPES"})," and select ",(0,r.jsx)(n.code,{children:"../auth/userinfo.email"})," and ",(0,r.jsx)(n.code,{children:"../auth/userinfo.profile"})," then click ",(0,r.jsx)(n.code,{children:"UPDATE"}),". Then click ",(0,r.jsx)(n.code,{children:"SAVE AND CONTINUE"})]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220178116-a4ca5ae1-c1a5-4da8-a4e5-21256484cfb3.png",height:"300"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"13",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Test Users. Click ",(0,r.jsx)(n.code,{children:"SAVE AND CONTINUE"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Summary. Click ",(0,r.jsx)(n.code,{children:"BACK TO DASHBOARD"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create OAuth client ID."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Application Type:"})," ",(0,r.jsx)(n.code,{children:"Web application"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name:"})," The name of your OAuth 2.0 client. This name is only used to identify the client in the console and will not be shown to end users."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authorized JavaScript origin:"})," Click ",(0,r.jsx)(n.code,{children:"ADD URI"})," and enter you server's URL. (Ex. ",(0,r.jsx)(n.code,{children:"https://sage3.manoa.hawaii.edu"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authorized Redirect URIs:"})," Click ",(0,r.jsx)(n.code,{children:"ADD URI"})," and enter you server's URL with the route ",(0,r.jsx)(n.code,{children:"/auth/google/redirect"})," attached. (Ex. ",(0,r.jsx)(n.code,{children:"https://sage3.manoa.hawaii.edu/auth/google/redirect"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"16",children:["\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.code,{children:"CREATE"})," and you should be shown the following screen with your ",(0,r.jsx)(n.code,{children:"CLIENT_ID"})," and ",(0,r.jsx)(n.code,{children:"CLIENT_SECRET"}),"."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220179572-9c39ae47-40d9-468f-8365-e118ec722048.png",height:"300"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"17",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Copy the ",(0,r.jsx)(n.code,{children:"CLIENT_ID"})," and ",(0,r.jsx)(n.code,{children:"CLIENT_SECRET"})," into the SAGE3 Server Configuration file located here: ",(0,r.jsx)(n.code,{children:"/configurations/node/sage3-prod.hjson"}),". They should be copied in the ",(0,r.jsx)(n.code,{children:"auth.googleConfig"})," fields under ",(0,r.jsx)(n.code,{children:"clientID"})," and ",(0,r.jsx)(n.code,{children:"clientSecret"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Ensure within the SAGE3 Server Configuration you have ",(0,r.jsx)(n.code,{children:"google"})," listed in the ",(0,r.jsx)(n.code,{children:"auth.strategies"})," array."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Test logging into your SAGE3 server using the ",(0,r.jsx)(n.code,{children:"Login with Google"})," button on the homepage."]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220174055-dc242c68-7e7c-4fcc-9b1b-d33d8fefd0ab.png",alt:"arch-detailed",height:"300"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"apple-login",children:"Apple Login"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Need an Apple Developer Account: ",(0,r.jsx)(n.a,{href:"https://developer.apple.com/account",children:"https://developer.apple.com/account"})]}),"\n",(0,r.jsxs)(n.li,{children:["Documentation:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:['Official documentation: "Sign in with Apple JS" ',(0,r.jsx)(n.a,{href:"https://developer.apple.com/documentation/sign_in_with_apple/sign_in_with_apple_js",children:"https://developer.apple.com/documentation/sign_in_with_apple/sign_in_with_apple_js"})]}),"\n",(0,r.jsxs)(n.li,{children:["Module documentation: ",(0,r.jsx)(n.a,{href:"https://github.com/ananay/apple-auth/blob/master/SETUP.md",children:"https://github.com/ananay/apple-auth/blob/master/SETUP.md"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["You will need several items:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a new App ID:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Navigate down to "Capabilities", and select "Sign in with Apple".'}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.img,{src:"https://github.com/SAGE-3/next/assets/5595452/ed60b9ea-7a6d-42a9-9b1a-37706bbd16f3",alt:"app_id"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.img,{src:"https://github.com/SAGE-3/next/assets/5595452/72e63b20-3588-4e89-bf3b-c95e7cff6bd9",alt:"app_id2"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Create a service ID","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:['Fill out the details, and click configure on "Sign in with Apple".',"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:['"Domains and Subdomains": the hostname of your server (e.g. ',(0,r.jsx)(n.code,{children:"sage3.hawaii.edu"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:['"Return URLs": the URL called back by Apple after login (e.g. ',(0,r.jsx)(n.a,{href:"https://sage3.hawaii.edu/auth/apple/redirect",children:"https://sage3.hawaii.edu/auth/apple/redirect"}),")"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.img,{src:"https://github.com/SAGE-3/next/assets/5595452/0d8ac501-c9ff-4500-80f8-c0820f51bfd9",alt:"web Authentication Configuration"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Create a key:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:['Go to the "Keys" section in your Developer account and create a key and configure on the "Sign in with Apple" option. Click continue and register. Click on ',(0,r.jsx)(n.code,{children:"Download"})," (your only chance) and rename it ",(0,r.jsx)(n.code,{children:"apple-key.p8"}),"."]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.img,{src:"https://github.com/SAGE-3/next/assets/5595452/488a5f00-86f9-4ee7-9224-028c90a0bded",alt:"key"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Configuring SAGE3:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json5",children:'    // Apple configuration\n    "appleConfig": {\n      // This is actually called the "Service ID" that you created in the \'Identifiers\' section\n      "clientID": "something com.sage3.blabla",\n      // Your Apple developer team ID: 10-character string, upper-case letters and numbers\n      "teamID": "XXXXXXXXXX",\n      // keyID is the identifier for the private key you generated: 10-character string, upper-case letters and numbers\n      "keyID": "XXXXXXXXXX",\n      // Private key file location that you downloaded\n      "privateKeyLocation": "./keys/apple-key.p8",\n      // The URL that Apple will call back after login, no need to change\n      "callbackURL": "/auth/apple/redirect",\n      "routeEndpoint": "/auth/apple"\n    },\n'})}),"\n",(0,r.jsx)(n.h3,{id:"cilogon",children:"CILogon"}),"\n",(0,r.jsx)(n.p,{children:"To enable CILogon Login for users from the Login page you must request a CILogon. CILogon provides a standards-compliant OpenID Connect (OAuth 2.0) interface to federated authentication for cyberinfrastructure."}),"\n",(0,r.jsx)(n.p,{children:"Instructions to do so are located here:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.cilogon.org/oidc",children:"CILogon OpenID Connect (OAuth 2.0)"})}),"\n",(0,r.jsxs)(n.p,{children:["To register, use this link: ",(0,r.jsx)(n.a,{href:"https://cilogon.org/oauth2/register",children:"CILogon Client Registration"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Client Name:"})," The Client Name is displayed to end-users on the Identity Provider selection page."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Contact Email:"})," This email address is used for operational notices regarding your client and for validating your affiliation. A mailing list address for your operations team is recommended."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Home URL:"})," URL of the Server (Ex. ",(0,r.jsx)(n.a,{href:"https://sage3.manoa.hawaii.edu",children:"https://sage3.manoa.hawaii.edu"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Callback URLs:"})," To ensure CILogon redirects back to the SAGE3 server after the user logins, postfix your server URL with: ",(0,r.jsx)(n.code,{children:"/auth/cilogon/redirect"}),". (Ex. ",(0,r.jsx)(n.a,{href:"https://sage3.manoa.hawaii.edu/auth/cilogon/redirect",children:"https://sage3.manoa.hawaii.edu/auth/cilogon/redirect"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Client Type:"})," Confidential"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scopes:"})," Ensure ",(0,r.jsx)(n.code,{children:"openid"})," and ",(0,r.jsx)(n.code,{children:"email"})," are selected."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Refresh Tokens:"})," No"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["After Registering the Client you should be shown a ",(0,r.jsx)(n.code,{children:"Client Identifier"})," and ",(0,r.jsx)(n.code,{children:"Client Secret"}),"."]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/222251416-0080d9bb-dbde-4e23-94d0-5a7c10fc5302.PNG",alt:"arch-detailed",height:"300"}),"\n",(0,r.jsxs)(n.p,{children:["Copy this down somewhere safe. OpenID OIDC should email you at the ",(0,r.jsx)(n.code,{children:"contact email"})," from above within a day or two to confirm your request has been approved."]}),"\n",(0,r.jsxs)(n.p,{children:["With in the Server Configuration file ",(0,r.jsx)(n.code,{children:"configurations/node/sage3-prod.hjson"})," under the ",(0,r.jsx)(n.code,{children:"auth.cilogonConfig"})," paste the ",(0,r.jsx)(n.code,{children:"Client Identifier"})," and the ",(0,r.jsx)(n.code,{children:"Client Secret"})," into their respective fields. Also ensure the array ",(0,r.jsx)(n.code,{children:"auth.strategies"})," contains ",(0,r.jsx)(n.code,{children:"cilogon"})," to enable the feature."]}),"\n",(0,r.jsxs)(n.p,{children:["Test logging into your SAGE3 server using the ",(0,r.jsx)(n.code,{children:"Login with CILogon"})," button on the homepage."]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220174055-dc242c68-7e7c-4fcc-9b1b-d33d8fefd0ab.png",alt:"arch-detailed",height:"300"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"Which should redirect to a page that looks like:"}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220174174-f25e1d05-4880-4f71-a498-668f81accae8.png",alt:"arch-detailed",height:"400"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"twilio",children:"Twilio"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://www.twilio.com",children:"Twilio"})," provides programmable communication tools for handling the Screenshare portion of SAGE3. It's an affordable option and allows multiple screenshares within board. SAGE3 uses Twilio's ",(0,r.jsx)(n.code,{children:"Video Groups"})," and more information about it can be found ",(0,r.jsx)(n.a,{href:"https://www.twilio.com/en-us/video/pricing",children:"here"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"To enable screen sharing on your SAGE3 server:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Signup for a Twilio Account. ",(0,r.jsx)(n.a,{href:"https://www.twilio.com/try-twilio",children:"Twilio Registration"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Verify your account."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"After creating you should be shown the page below. Select:"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Video"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Other"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"With code"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"JavaScript"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"No, I want to use my own hosting service"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Then click ",(0,r.jsx)(n.code,{children:"Get Started with Twilio"}),"."]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220181384-77a0e96e-45a3-4c8b-99f9-5de281399b43.png",alt:"arch-detailed",height:"500"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["Navigate to the ",(0,r.jsx)(n.code,{children:"Auth Token & API Keys"})]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220181596-28c7b1c8-1531-4604-9a07-5fb2ff8df734.png",alt:"arch-detailed",height:"500"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.code,{children:"Create API key"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Fill in the form."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Friendly name:"})," A friendly name for this ",(0,r.jsx)(n.code,{children:"API Key"})," that shows in the Twilio console."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Region:"})," Select the region that is closest to the majority of your SAGE3 users."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Key type:"})," Standard"]}),"\n"]}),"\n",(0,r.jsx)("img",{src:"https://user-images.githubusercontent.com/19752298/220181925-d4630a63-115b-4f0b-aa5a-da07da238b1c.png",alt:"arch-detailed",height:"300"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["You will then be shown your ",(0,r.jsx)(n.code,{children:"SID"})," and ",(0,r.jsx)(n.code,{children:"Secret"}),". Copy these down somewhere safe. Click ",(0,r.jsx)(n.code,{children:"Done"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Navigate to the ",(0,r.jsx)(n.code,{children:"Auth Token & API Keys"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Under ",(0,r.jsx)(n.code,{children:"Live credentials"})," copy down the ",(0,r.jsx)(n.code,{children:"Account SID"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["You will now have three keys/tokens. ",(0,r.jsx)(n.code,{children:"Account SID"}),", ",(0,r.jsx)(n.code,{children:"SID"}),", and ",(0,r.jsx)(n.code,{children:"Secret"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Copy these keys/tokens to the SAGE3 Server Configuration file located ",(0,r.jsx)(n.code,{children:"/configurations/node/sage3-prod.hjson"}),". Under the ",(0,r.jsx)(n.code,{children:"services.twilio"})," enter the three keys/tokens into the following fields:"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["accountSid: ",(0,r.jsx)(n.code,{children:"Account SID"})]}),"\n",(0,r.jsxs)(n.li,{children:["apiKey: ",(0,r.jsx)(n.code,{children:"SID"})]}),"\n",(0,r.jsxs)(n.li,{children:["apiSecret: ",(0,r.jsx)(n.code,{children:"Secret"})]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"12",children:["\n",(0,r.jsxs)(n.li,{children:['Ensure the "Screenshare" app is enabled by adding "Screenshare" to the ',(0,r.jsx)(n.code,{children:"features.apps"})," array in the SAGE3 Server Configuration file located ",(0,r.jsx)(n.code,{children:"/configurations/node/sage3-prod.hjson"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);